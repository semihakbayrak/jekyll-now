---
layout: post
title: Switching State Space Models and Structured Variational Inference
---
![alt text](https://semihakbayrak.github.io/images/sssm.jpeg "SSSM")

Used in broad range of areas from robotics to finance, State Space Models (a.k.a. Kalman filters) assume a stationary generative process of temporal data. Some temporal data, on the other hand, are generated by switching regimes through time. For example, a mechanical part of a wind turbine could be tracked well by only one Kalman filter if the wind speed were constant. However, wind turbines should be designed such a way that the behaviour of mechanical parts are segmented according to speed and direction of wind for the sake of efficient energy transformation. So, detection of wind regime is crucial in wind turbine design. Switching State Space Models (SSSMs) address this kind of non-stationary behaviours with mixture of Kalman filters. Depicted in the figure above, an SSSM is a composition of Kalman filter and hidden Markov models (HMMs). To be more precise, the generative model: 

$$ 
p(\mathbf{y}_{1:T},\mathbf{x}_{1:T},\mathbf{z}_{1:T}) = p(\mathbf{z}_1)p(\mathbf{x}_1|\mathbf{z}_1)p(\mathbf{y}_1|\mathbf{x}_1,\mathbf{z}_1)\prod\limits_{t=2}^{T}{p(\mathbf{z}_t|\mathbf{z}_{t-1})p(\mathbf{x}_t|\mathbf{x}_{t-1},\mathbf{z}_t)p(\mathbf{y}_t|\mathbf{x}_t,\mathbf{z}_t)} 
$$.

Let's take a closer look at the conditional distributions, starting with the continuous latent variables:

$$
p(\mathbf{x}_t|\mathbf{x}_{t-1},\mathbf{z}_t) = \mathcal{N}(\mathbf{x}_t;\mathbf{A}_t\mathbf{x}_{t-1},\mathbf{V}_t)
$$,

where $\mathbf{A}_t \in \\{\mathbf{A}^{k}\\}_{k=1}^{K}$ and $k=z_t$.

As it can be imagined, exact inference for such a model is intractable. So, we resort to variational bound optimization with some relaxations in the recognition distribution. The most relaxed recognition model choice is the one all the random variables are factorized. However, it is a better practice to stick to the original model factorization in order to keep variational objective tighter to the log-likelihood.
